// –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π
const Navigation = {
    // –ú–∞–ø–ø–∏–Ω–≥ —Å—Ç—Ä–∞–Ω–∏—Ü (–î–û–ë–ê–í–õ–Ø–ï–ú –ù–û–í–´–ï –°–¢–†–ê–ù–ò–¶–´)
    pages: {
        'main': 'pages/main.html',
        'first-line': 'pages/first-line.html',
        'second-line': 'pages/second-line.html',
        'restaurants': 'pages/restaurants.html',
        'cash-servers': 'pages/cash-servers.html',
        'cash-registers': 'pages/cash-registers.html',
        'cash-details': 'pages/cash-details.html',
        'manager-pcs': 'pages/manager-pcs.html',
        'music-pcs': 'pages/music-pcs.html',
        'device-details': 'pages/device-details.html',
        'service-printers': 'pages/service-printers.html',
        'printer-departments': 'pages/printer-departments.html',
        'printer-details': 'pages/printer-details.html',
        'cash-server-management': 'pages/cash-server-management.html',
        'cash-server-services': 'pages/cash-server-services.html',
        'service-management': 'pages/service-management.html',
        'services-status': 'pages/services-status.html',
        'services': 'pages/services.html',
        'service-management-global': 'pages/service-management-global.html',
        'crm-services': 'pages/crm-services.html',
        'calendar': 'pages/calendar.html',
        'scheduled-messages': 'pages/scheduled-messages.html'
    },

    // –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü (–î–û–ë–ê–í–õ–Ø–ï–ú –ù–û–í–´–ï –ó–ê–ì–û–õ–û–í–ö–ò)
    pageTitles: {
        'main': '–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞',
        'first-line': '1st Line - –í—ã–±–æ—Ä —Ä–∞–∑–¥–µ–ª–∞',
        'second-line': '2nd Line - –°–∏—Å—Ç–µ–º—ã',
        'restaurants': '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞–º–∏',
        'cash-servers': '–ö–∞—Å—Å–æ–≤—ã–µ —Å–µ—Ä–≤–µ—Ä—ã',
        'cash-registers': '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Å—Å–∞–º–∏',
        'cash-details': '–î–µ—Ç–∞–ª–∏ –∫–∞—Å—Å—ã',
        'manager-pcs': '–ü–ö –ú–µ–Ω–µ–¥–∂–µ—Ä–∞',
        'music-pcs': '–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –º–æ–Ω–æ–±–ª–æ–∫–∏',
        'device-details': '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º',
        'service-printers': '–°–µ—Ä–≤–∏—Å –ø—Ä–∏–Ω—Ç–µ—Ä—ã',
        'printer-departments': '–í—ã–±–æ—Ä —Ü–µ—Ö–∞',
        'printer-details': '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–º',
        'cash-server-management': '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–º',
        'cash-server-services': '–°–ª—É–∂–±—ã —Å–µ—Ä–≤–µ—Ä–∞',
        'service-management': '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª—É–∂–±–æ–π',
        'services-status': '–°—Ç–∞—Ç—É—Å —Å–ª—É–∂–±',
        'services': '–°–ª—É–∂–±—ã',
        'service-management-global': '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª—É–∂–±–æ–π',
        'crm-services': '–°–ª—É–∂–±—ã CRM',
        'calendar': '–ö–∞–ª–µ–Ω–¥–∞—Ä—å –¥–µ–∂—É—Ä—Å—Ç–≤',
        'scheduled-messages': '–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è'
    },

    // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
    showPage: function(pageId) {
        const pageUrl = this.pages[pageId];
        if (!pageUrl) {
            console.error('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞:', pageId);
            return;
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
        this.loadPage(pageUrl, pageId);
    },

    // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
    loadPage: function(url, pageId) {
        fetch(url)
            .then(response => {
                if (!response.ok) throw new Error('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                return response.text();
            })
            .then(html => {
                document.getElementById('page-content').innerHTML = html;
                this.updateHeader(pageId);
                this.animatePage();
                
                // –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –µ—ë –ª–æ–≥–∏–∫—É
                this.initializePage(pageId);
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:', error);
            });
    },

   // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ (–û–ë–ù–û–í–õ–Ø–ï–ú –° –ü–†–û–í–ï–†–ö–ê–ú–ò)
initializePage: function(pageId) {
    switch(pageId) {
        case 'cash-registers':
            console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞—Å—Å...');
            if (typeof CashManager !== 'undefined') {
                CashManager.initializeCashList();
            }
            break;
        case 'cash-details':
            console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–µ—Ç–∞–ª–µ–π –∫–∞—Å—Å—ã...');
            if (typeof CashManager !== 'undefined') {
                CashManager.loadCashDetails();
            }
            break;
        case 'manager-pcs':
            console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ü–ö –º–µ–Ω–µ–¥–∂–µ—Ä–∞...');
            if (typeof PCManager !== 'undefined' && PCManager.initialize) {
                PCManager.initialize(PCManager.deviceTypes.MANAGER_PC);
            }
            break;
        case 'music-pcs':
            console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –º—É–∑—ã–∫–∞–ª—å–Ω—ã—Ö –º–æ–Ω–æ–±–ª–æ–∫–æ–≤...');
            if (typeof PCManager !== 'undefined' && PCManager.initialize) {
                PCManager.initialize(PCManager.deviceTypes.MUSIC_PC);
            }
            break;
        case 'device-details':
            console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–µ—Ç–∞–ª–µ–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞...');
            this.initializeDeviceDetailsPage();
            break;
        case 'service-printers':
            console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–µ—Ä–≤–∏—Å –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤...');
            if (typeof PrinterManager !== 'undefined' && PrinterManager.initialize) {
                PrinterManager.initialize();
            } else {
                console.error('‚ùå PrinterManager –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω');
            }
            break;
        case 'printer-departments':
            console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤—ã–±–æ—Ä–∞ —Ü–µ—Ö–∞...');
            if (typeof PrinterManager !== 'undefined' && PrinterManager.loadDepartmentsPage) {
                PrinterManager.loadDepartmentsPage();
            }
            break;
        case 'printer-details':
            console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–µ—Ç–∞–ª–µ–π –ø—Ä–∏–Ω—Ç–µ—Ä–∞...');
            if (typeof PrinterManager !== 'undefined' && PrinterManager.loadPrinterDetails) {
                PrinterManager.loadPrinterDetails();
            }
            break;
        case 'restaurants':
            console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤...');
            break;
             case 'cash-servers':
                console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞—Å—Å–æ–≤—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤...');
                if (typeof CashServerManager !== 'undefined' && CashServerManager.initialize) {
                    CashServerManager.initialize();
                }
                break;
            case 'cash-server-management':
                console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–æ–º...');
                if (typeof CashServerManager !== 'undefined' && CashServerManager.loadServerManagementPage) {
                    CashServerManager.loadServerManagementPage();
                }
                break;
            case 'cash-server-services':
                console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–ª—É–∂–± —Å–µ—Ä–≤–µ—Ä–∞...');
                if (typeof CashServerManager !== 'undefined' && CashServerManager.loadServicesPage) {
                    CashServerManager.loadServicesPage();
                }
                break;
            case 'service-management':
                console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ª—É–∂–±–æ–π...');
                if (typeof CashServerManager !== 'undefined' && CashServerManager.loadServiceManagementPage) {
                    CashServerManager.loadServiceManagementPage();
                }
                break;
            case 'services-status':
                console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å—Ç–∞—Ç—É—Å–∞ —Å–ª—É–∂–±...');
                if (typeof CashServerManager !== 'undefined' && CashServerManager.loadServicesStatusPage) {
                    CashServerManager.loadServicesStatusPage();
                }
                break;
             case 'services':
                console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–ª—É–∂–±...');
                // –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
                break;
            case 'crm-services':
                console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–ª—É–∂–± CRM...');
                if (typeof ServicesManager !== 'undefined' && ServicesManager.loadCrmServicesPage) {
                    ServicesManager.loadCrmServicesPage();
                }
                break;
            case 'service-management-global':
                console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π —Å–ª—É–∂–±–æ–π...');
                if (typeof ServicesManager !== 'undefined' && ServicesManager.loadServiceManagementPage) {
                    ServicesManager.loadServiceManagementPage();
                }
                break;
            case 'calendar':
                console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞–ª–µ–Ω–¥–∞—Ä—è...');
                if (typeof CalendarManager !== 'undefined' && CalendarManager.loadCalendarPage) {
                    CalendarManager.loadCalendarPage();
                }
                break;
            case 'scheduled-messages':
                console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π...');
                if (typeof ScheduledMessagesManager !== 'undefined' && ScheduledMessagesManager.loadScheduledMessagesPage) {
                ScheduledMessagesManager.loadScheduledMessagesPage();
                }
                break;
           
            }
},

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–µ—Ç–∞–ª–µ–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
    initializeDeviceDetailsPage: function() {
        if (typeof PCManager !== 'undefined') {
            PCManager.loadDeviceDetails();
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É "–ù–∞–∑–∞–¥" –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        this.initializeBackButton();
    },

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥" –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã device-details
    initializeBackButton: function() {
        const backBtn = document.getElementById('deviceBackBtn');
        if (backBtn) {
            backBtn.addEventListener('click', () => {
                this.handleDeviceDetailsBack();
            });
        }
    },

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥" –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ device-details
    handleDeviceDetailsBack: function() {
        const deviceType = sessionStorage.getItem('selectedDeviceType');
        
        if (deviceType === 'manager_pc') {
            this.showPage('manager-pcs');
        } else if (deviceType === 'music_pc') {
            this.showPage('music-pcs');
        } else {
            // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã
            this.showPage('restaurants');
        }
    },

    // –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫
    updateHeader: function(pageId) {
        const subtitle = this.pageTitles[pageId] || 'Remote mini';
        const subtitleElement = document.querySelector('.header .subtitle');
        if (subtitleElement) {
            subtitleElement.textContent = subtitle;
        }
    },

    // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    animatePage: function() {
        const elements = document.querySelectorAll('.btn, .card, .server-item');
        elements.forEach((el, index) => {
            el.style.opacity = '0';
            el.style.transform = 'translateY(20px)';
            
            setTimeout(() => {
                el.style.transition = 'all 0.5s ease';
                el.style.opacity = '1';
                el.style.transform = 'translateY(0)';
            }, index * 50);
        });
    }
};
